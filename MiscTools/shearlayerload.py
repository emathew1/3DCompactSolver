# -*- coding: utf-8 -*-
"""
Created on Fri Jan 19 18:52:40 2018

@author: mat.mathews
"""

#%%

import numpy as np
import matplotlib.pyplot as plt


filename = './uAvg.out'
filenamerho = './rhoAvg.out'
dataIn = np.loadtxt(filename,dtype=np.double)
dataInRho = np.loadtxt(filenamerho,dtype=np.double)
delU = 2.2

#%%

Nt = np.shape(dataIn)[0]
Ny = np.shape(dataIn)[1]
t  = np.empty(Nt,dtype=np.double)
uAvg   = np.empty((Nt,Ny-1),dtype=np.double)
rhoAvg = np.empty((Nt,Ny-1),dtype=np.double)

for i in range(0,Nt):
    t[i] = dataIn[i,0]
    uAvg[i] = dataIn[i,1:]
    rhoAvg[i] = dataInRho[i,1:]
    

#%%
momThick = np.empty(Nt,dtype=np.double)
for i in range(0,Nt):
    momThick[i] = np.trapz(rhoAvg[i]*(-uAvg[i,:]+delU/2)*(uAvg[i,:]+delU/2))/delU**2
    
#%%

A3 = [0, 0.9923076923076923, 60.3174603174603, 1.7769230769230777, 114.28571428571428, 2.815384615384616,142.8571428571429, 3.4153846153846157,171.4285714285714, 3.9923076923076923,200, 4.546153846153846,230.15873015873018, 5.0769230769230775,258.7301587301587, 5.515384615384616,287.3015873015873, 5.953846153846153,314.2857142857143, 6.438461538461539,342.8571428571429, 6.876923076923077,395.2380952380953, 7.661538461538461,453.96825396825386, 8.584615384615384, 511.1111111111111, 9.392307692307693]
AS3 = [-1.5873015873015959, 0.9923076923076923,80.9523809523809, 2.1461538461538474,160.3174603174603, 3.5999999999999996,198.41269841269838, 4.292307692307693,238.09523809523807, 4.961538461538462,271.4285714285714, 5.561538461538461,309.5238095238095, 6.253846153846154,347.61904761904765, 7.015384615384615,384.1269841269841, 7.707692307692308]

A3t = A3[0::2]
A3d = A3[1::2]
AS3t = AS3[0::2]
AS3d = AS3[1::2]

AS11 =  [0, 0.9917355371900847,95.62841530054646, 1.9834710743801658,131.14754098360658, 2.4000000000000004,247.26775956284155, 4.06611570247934,360.655737704918, 5.553719008264463,472.67759562841525, 6.942148760330579,587.4316939890709, 8.132231404958679,702.1857923497267, 9.203305785123968,816.9398907103825, 10.19504132231405,935.7923497267758, 11.047933884297523]
AS11t = AS11[0::2]
AS11d = AS11[1::2]

A11 = [0, 0.9719008264462818,94.26229508196718, 2.003305785123967,180.327868852459, 3.2330578512396695,266.3934426229508, 4.542148760330578,349.7267759562841, 5.692561983471076,433.06010928961746, 6.763636363636365,515.0273224043716, 7.616528925619836,599.7267759562842, 8.390082644628102,685.792349726776, 9.22314049586777, 773.2240437158471, 9.917355371900829,856.5573770491802, 10.55206611570248,941.2568306010929, 11.166942148760333]
A11t = A11[0::2]
A11d = A11[1::2]

#%%

plt.plot(t*delU,momThick/momThick[0],'b',A3t,A3d,'ok-',AS3t,AS3d,'sr-')

#%%

plt.plot(t*delU,momThick/momThick[0],'b',A11t, A11d,'ok-',AS11t, AS11d,'sr-')

#%%
y = np.linspace(0,Ny-1,Ny-1)
yy = 0.3*np.tanh(-(y-(Ny-1)/2)/2)

#%%
x = np.linspace(50,550,100)
xy = 0.016*x + 1

plt.plot(x,xy,'k',t*delU,momThick/momThick[0],'b',A3t,A3d,'ok-',AS3t,AS3d,'sr-')

